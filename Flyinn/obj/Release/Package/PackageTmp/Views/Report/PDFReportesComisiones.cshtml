@model List<Flyinn.Models.Empleado>
@{ double TotalCertificados = 0.00; double TotalContratos = 0.00; int CantidadCertificados = 0; int CantidadContratos = 0; }
<style>
    body {
        font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
        font-size: 14px;
    }

    h1 {
        margin-top: 25px;
        text-align: center;
        font-size:20px;
    }

    h2 {
        margin-top: 25px;
        text-align: center;
    }

    h3 {
        margin-top: 25px;
        text-align: center;
    }

    h4 {
        margin-top: 25px;
    }

    div {
        margin-left: 2em;
    }

    table {
        margin: 20px;
        width: 100%;
        text-align: left;
        border-collapse: collapse;
    }

    th {
        font-size: 12px;
        font-weight: normal;
       /* background: #b9c9fe;*/
        background: #e8edff;
       /* border-top: 1px solid #aabcfe;*/
        border-bottom: 1px solid #fff;
        border-top: 1px solid transparent;
        /* border-bottom: 1px solid #fff;*/
        height: 5px;
    }

    td {
        font-size: 12px;
        font-weight: normal;
        height:5px;
        /*background: #e8edff;*/
        border-bottom: 1px solid #fff;
        border-top: 1px solid transparent;
    }

    .foto img {
        border: 2px solid #08088A;
        
    }
</style>


    
 
    @*<div>        
        <img src="~/Content/EstiloLogin/images/LOGO%20SUNSOL%20HOTELES.png" />
        
    </div>*@
<h1>Reporte de Comisiones</h1>
<p align="center">Desde el <b> @Convert.ToString(@Model[0].fechaInicio).Substring(0, 10) </b>  hasta el <b> @Convert.ToString(@Model[0].fechaFin).Substring(0, 10) </b></p>
<img src="/Flyinn/Content/EstiloLogin/images/LOGOSUNSOLHOTELES.png" />
    <table class="table table-striped table-bordered" id="example3">
     
        @if (@Model != null)
        {
           foreach (var item in @Model)
            {
                if (@item.Nombres != "SIN SUPERVISOR" && @item.Nombres != "SIN GERENTE" && @item.Nombres != "SIN COORDINADOR" && @item.Nombres != "SIN PROMOTOR")
                { 
                <tr>
                   
                    <th><strong>EMPLEADO</strong></th>
                    <th><strong>Cargos</strong></th>
                </tr>
                <tr>
                    <td>@item.Nombres</td>
                    <td>@item.Cargo.Descripcion</td>
                </tr>
                <tr><th style="font-weight:bolder"><div align="center"><strong>Cantidad de Certificados</strong></div></th><th style="font-weight:bolder"><div align="center"><strong>Monto Total Certificados</strong></div></th></tr>
             <!---->   <tr><td style="font-weight:bolder"><div align="center">@item.CantidadCertificados</div></td><td style="font-weight:bolder"><div align="center">@String.Format("{0:N}", decimal.Parse(Convert.ToString(@item.TotalCertificados)))</div></td></tr>
            
                           
                <tr><th style="font-weight:bolder"><div align="center"><strong>Cantidad de Contratos</strong></div></th><th style="font-weight:bolder"><div align="center"><strong>Monto Total Contratos</strong></div></th></tr>
                <tr><td style="font-weight:bolder"><div align="center">@item.CantidadContratos</div></td><td style="font-weight:bolder"><div align="center">@String.Format("{0:N}", decimal.Parse(Convert.ToString(@item.TotalContratos)))</div></td></tr>
            
             
                 <tr><th style="font-weight:bolder"><div align="center"></div></th><th style="font-weight:bolder"><div align="center"><STRONG>Monto Total</STRONG></div></th></tr>
                <tr><td style="font-weight:bolder"><div align="center"></div></td><td style="font-weight:bolder"><div align="center">@String.Format("{0:N}", decimal.Parse(Convert.ToString(@item.TotalContratos + @item.TotalCertificados)))</div></td></tr>
                
                <tr style="height: 1px; background-color: #6E6E6E; "><th colspan="2"></th></tr>   
                { TotalCertificados += item.TotalCertificados;
                   TotalContratos += item.TotalContratos;
                   CantidadCertificados += item.CantidadCertificados;
                   CantidadContratos += CantidadContratos;} 
        }          
            }
            
             <tr><td style=" font-weight:bolder"><div align="center"></div></td><td style="font-weight:bolder"><div align="center"></div></td></tr>
             <tr><th style="font-weight:bolder"><div align="center"></div></th><th style="font-weight:bolder"><div align="center"><strong>Monto General Certificados</strong></div></th></tr>
             <tr><td style="font-weight:bolder"><div align="center"></div></td><td style="font-weight:bolder"><div align="center">@String.Format("{0:N}", decimal.Parse(Convert.ToString(TotalCertificados)))</div></td></tr>
             <tr><th style="font-weight:bolder"><div align="center"></div></th><th style="font-weight:bolder"><div align="center"><strong>Monto General Contratos</strong></div></th></tr>
             <tr><td style="font-weight:bolder"><div align="center"></div></td><td style="font-weight:bolder"><div align="center">@String.Format("{0:N}", decimal.Parse(Convert.ToString(TotalContratos)))</div></td></tr>          
             <tr><th style="font-weight:bolder"><div align="center"></div></th><th style="font-weight:bolder"><div align="center"><strong>Total General</strong> </div></th></tr>
             <tr><td style="font-weight:bolder"><div align="center"></div></td><td style="font-weight:bolder"><div align="center">@String.Format("{0:N}", decimal.Parse(Convert.ToString(TotalContratos + TotalCertificados)))</div></td></tr>

        }
    </table>
